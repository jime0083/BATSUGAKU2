================================================================================
cogsec氏 Claude Code 設定ガイド
================================================================================

セットアップ完了日: 2026-01-20
ソース: https://github.com/affaan-m/everything-claude-code

================================================================================
インストール済みコンポーネント
================================================================================

| コンポーネント | 場所                              | ファイル数 |
|---------------|-----------------------------------|-----------|
| Agents        | ~/.claude/agents/                 | 9個       |
| Rules         | ~/.claude/rules/                  | 8個       |
| Commands      | ~/.claude/commands/               | 9個       |
| Skills        | ~/.claude/skills/                 | 7個       |
| Hooks         | ~/.claude/settings.json           | 設定済み   |
| MCP参照       | ~/.claude/mcp-servers-reference.json | 参照用  |

================================================================================
1. Agents（エージェント）
================================================================================

目的: タスクを専門のサブエージェントに委任して並列処理を実現

┌─────────────────────┬──────────────────────────────────────┐
│ エージェント         │ 用途                                 │
├─────────────────────┼──────────────────────────────────────┤
│ planner             │ 機能実装の計画立案                    │
│ architect           │ システム設計・アーキテクチャ決定       │
│ code-reviewer       │ コード品質・セキュリティレビュー       │
│ security-reviewer   │ 脆弱性分析・セキュリティ監査          │
│ tdd-guide           │ テスト駆動開発のガイド                │
│ e2e-runner          │ Playwrightを使ったE2Eテスト          │
│ build-error-resolver│ ビルドエラーの解決                   │
│ refactor-cleaner    │ デッドコード削除・リファクタリング    │
│ doc-updater         │ ドキュメント同期・更新                │
└─────────────────────┴──────────────────────────────────────┘

================================================================================
2. Commands（スラッシュコマンド）
================================================================================

目的: よく使う操作をワンコマンドで実行

┌─────────────────┬────────────────────────────────┐
│ コマンド        │ 機能                           │
├─────────────────┼────────────────────────────────┤
│ /tdd            │ テスト駆動開発ワークフロー起動  │
│ /plan           │ 実装計画の作成                 │
│ /e2e            │ E2Eテスト生成・実行            │
│ /code-review    │ コードレビュー実施             │
│ /build-fix      │ ビルドエラー修正               │
│ /refactor-clean │ リファクタリング・クリーンアップ│
│ /test-coverage  │ カバレッジ分析                 │
│ /update-docs    │ ドキュメント更新               │
│ /update-codemaps│ コードマップ更新               │
└─────────────────┴────────────────────────────────┘

================================================================================
3. Rules（ルール）
================================================================================

目的: 常に従うべきガイドライン

┌─────────────────┬────────────────────────────────────┐
│ ルール          │ 内容                               │
├─────────────────┼────────────────────────────────────┤
│ security.md     │ APIキー漏洩防止、入力検証など       │
│ coding-style.md │ イミュータビリティ、ファイル分割    │
│ testing.md      │ TDD強制、80%カバレッジ要件         │
│ git-workflow.md │ コミット形式、PR作成ルール         │
│ performance.md  │ モデル選択、コンテキスト管理        │
│ patterns.md     │ API応答形式、設計パターン          │
│ agents.md       │ エージェント使用タイミング          │
│ hooks.md        │ フック動作の説明                   │
└─────────────────┴────────────────────────────────────┘

================================================================================
4. Skills（スキル）
================================================================================

目的: ドメイン知識とワークフロー定義

┌────────────────────────────┬──────────────────────────────────┐
│ スキル                     │ 内容                             │
├────────────────────────────┼──────────────────────────────────┤
│ coding-standards.md        │ TypeScript/React/Node.jsベストプラクティス │
│ backend-patterns.md        │ API、DB、キャッシュパターン       │
│ frontend-patterns.md       │ React/Next.jsパターン            │
│ tdd-workflow/              │ TDD方法論の詳細                  │
│ security-review/           │ セキュリティチェックリスト        │
│ clickhouse-io.md           │ ClickHouseアナリティクス         │
│ project-guidelines-example.md │ プロジェクト固有設定例        │
└────────────────────────────┴──────────────────────────────────┘

================================================================================
5. Hooks（フック）
================================================================================

目的: ツール実行時の自動処理

【PreToolUse（実行前）】
  - devサーバーはtmux内でのみ実行を許可
  - 長時間コマンド実行時にtmux使用を推奨
  - git push前に確認を表示
  - 不要な.mdファイル作成をブロック

【PostToolUse（実行後）】
  - PR作成後にURLとレビューコマンドを表示
  - JS/TSファイル編集後にPrettierで自動整形
  - TypeScriptファイル編集後に型チェック
  - console.logの警告表示

【Stop（終了時）】
  - 変更ファイル内のconsole.logを最終監査

================================================================================
使い方ガイド
================================================================================

【基本的なワークフロー】

1. 機能実装時
   /plan        → 計画作成
   /tdd         → テスト駆動で実装
   /code-review → レビュー
   /build-fix   → エラー修正

2. リファクタリング時
   /refactor-clean → 不要コード削除
   /test-coverage  → カバレッジ確認

3. E2Eテスト
   /e2e → Playwrightテスト生成・実行

================================================================================
MCP設定（オプション）
================================================================================

必要なMCPサーバーを有効化するには：
1. ~/.claude/mcp-servers-reference.json を参照
2. 必要なものを ~/.claude.json の mcpServers セクションにコピー
3. APIキーを設定

【利用可能なMCPサーバー】
  - GitHub      : PR/Issue管理
  - Supabase    : DB操作
  - Vercel      : デプロイ
  - Railway     : デプロイ
  - Firecrawl   : Webスクレイピング
  - Memory      : セッション間記憶
  - Context7    : ドキュメント検索
  - Cloudflare  : Workers/ドキュメント
  - ClickHouse  : アナリティクス

【注意】
MCPは10個以下を有効化することを推奨（コンテキストウィンドウ節約のため）

================================================================================
推奨される開発フロー
================================================================================

【新機能開発】

  1. /plan で計画立案（plannerエージェント使用）
  2. /tdd でRED-GREEN-REFACTORサイクル
  3. /code-review でセキュリティ・品質チェック
  4. /test-coverage で80%以上を確認
  5. git commit & push

【TDDサイクル】

  RED     → 失敗するテストを書く
  GREEN   → テストを通す最小限のコードを書く
  REFACTOR → コードを改善（テストは通したまま）
  REPEAT  → 次の機能へ

================================================================================
重要な注意点
================================================================================

【コンテキストウィンドウ管理】
  - 200kのコンテキストが70kに縮小する可能性あり
  - MCPは20〜30個設定し、プロジェクトごとに10個以下を有効化
  - アクティブツールは80個以下に

【セキュリティ】
  - APIキーは絶対にハードコードしない
  - 環境変数を使用
  - 入力は必ず検証

【カスタマイズ】
  - プロジェクトに合わせてルールを調整
  - 使わないものは削除してOK
  - 独自のパターンを追加可能

================================================================================
参考リンク
================================================================================

リポジトリ: https://github.com/affaan-m/everything-claude-code
作者X: https://x.com/affaanmustafa
完全ガイド: https://x.com/affaanmustafa/status/2012378465664745795

================================================================================
